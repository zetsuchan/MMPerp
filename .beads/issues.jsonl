{"id":"MMPerp-0ox","title":"Missing find_account/find_market implementations in risk_engine.cpp","description":"PR #1 declares find_account() and find_market() in risk_engine.hpp but only implements get_all_accounts() in risk_engine.cpp. The missing implementations will cause linker errors. Must add:\n```cpp\nconst AccountState* RiskEngine::find_account(common::AccountId account) const {\n  auto it = accounts_.find(account);\n  return it != accounts_.end() ? \u0026it-\u003esecond : nullptr;\n}\n\nconst MarketState* RiskEngine::find_market(common::MarketId market) const {\n  auto it = markets_.find(market);\n  return it != markets_.end() ? \u0026it-\u003esecond : nullptr;\n}\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-30T20:15:49.624942-05:00","updated_at":"2025-11-30T20:19:44.795841-05:00","closed_at":"2025-11-30T20:19:44.795844-05:00","comments":[{"id":14,"issue_id":"MMPerp-0ox","author":"danchou","text":"Fixed on main: exposed AccountState/MarketState/PositionState as public types, added get_all_accounts() implementation. PR #1 can now compile after rebase.","created_at":"2025-12-01T01:19:38Z"}]}
{"id":"MMPerp-2jy","title":"Liquidation orders use INT64_MAX/MIN instead of mark price spread","description":"In PR #1 liquidation_executor.cpp:56-57, liquidation orders use extreme prices:\n```cpp\n.price = (order.side == common::Side::kBuy) ? std::numeric_limits\u003cstd::int64_t\u003e::max() \n                                              : std::numeric_limits\u003cstd::int64_t\u003e::min(),\n```\nProduction liquidations typically use mark_price +/- spread, not INT64_MAX/MIN. This gives infinite slippage to liquidators and disadvantages the liquidated account.","status":"open","priority":3,"issue_type":"chore","created_at":"2025-11-30T20:15:57.73954-05:00","updated_at":"2025-11-30T20:15:57.73954-05:00"}
{"id":"MMPerp-4m0","title":"Add fuzz testing suite for matcher, risk engine, WAL parser","description":"Currently only unit harness runs. Need comprehensive fuzz testing for critical components before production.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:19:56.427319-05:00","updated_at":"2025-11-30T19:19:56.427319-05:00"}
{"id":"MMPerp-4ox","title":"Remove no-op replay event handler in production main","description":"Empty lambda at apps/tradecored/src/main.cpp:57 serves no purpose. Code: replay.set_event_handler([](const wal::Record\u0026) {}); Should be real event processing or omitted entirely. (Mock/stub removal)","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-11-30T19:19:56.848352-05:00","updated_at":"2025-11-30T19:31:02.205044-05:00","closed_at":"2025-11-30T19:31:02.205046-05:00","comments":[{"id":3,"issue_id":"MMPerp-4ox","author":"danchou","text":"Resolved in MMPerp-677 - new main.cpp no longer has the no-op event handler","created_at":"2025-12-01T00:31:02Z"}]}
{"id":"MMPerp-677","title":"Add TOML/JSON config loader with validation","description":"Engine uses hard-coded configs for risk/funding/ingress. Need config file support before production. File: include/tradecore/config.hpp","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T19:19:34.573686-05:00","updated_at":"2025-11-30T19:30:43.595629-05:00","closed_at":"2025-11-30T19:30:43.595632-05:00","comments":[{"id":1,"issue_id":"MMPerp-677","author":"danchou","text":"Implemented TOML config loader with toml++ library. Added ConfigLoader class with load(), validate(), and generate_default() methods. Updated main.cpp to load from file with fallback to generated defaults. Created tradecore.toml.example.","created_at":"2025-12-01T00:30:36Z"}]}
{"id":"MMPerp-6qg","title":"Implement real event loop in production main","description":"Production main.cpp is a bootstrap skeleton that immediately exits after setup. Need real event loop with signal handling for production daemon. File: apps/tradecored/src/main.cpp","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:20:11.335574-05:00","updated_at":"2025-11-30T19:20:11.335574-05:00"}
{"id":"MMPerp-8ef","title":"Split monolithic tests/unit/main.cpp into per-component test files","description":"Single 233-line test file with all tests inline is hard to maintain. Split into separate files per component (matcher, risk, funding, etc.). File: tests/unit/main.cpp","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-11-30T19:19:56.7052-05:00","updated_at":"2025-11-30T20:04:38.084194-05:00","closed_at":"2025-11-30T20:04:38.084198-05:00","comments":[{"id":9,"issue_id":"MMPerp-8ef","author":"danchou","text":"Split monolithic main.cpp (233 lines) into 8 per-component test files: test_api, test_ledger, test_risk, test_telemetry, test_ingest, test_funding, test_matcher, test_persistence. Each file has header+impl with namespaced test functions. main.cpp now just calls all test functions. Build and tests pass.","created_at":"2025-12-01T01:04:38Z"}]}
{"id":"MMPerp-8gv","title":"Migrate risk engine to 64.32 fixed-point math for precision","description":"Current integer approximations for funding and margin calculations may cause precision issues. Consider 64.32 fixed-point for consistency. Add stress-test coverage for cross-market portfolio margin. File: libs/risk/include/tradecore/risk/risk_engine.hpp","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:20:11.114357-05:00","updated_at":"2025-11-30T19:20:11.114357-05:00"}
{"id":"MMPerp-axd","title":"ApiRouter vectors grow unbounded - memory leak in production","description":"In PR #1 api_router.hpp, express_feed_frames_ and trade_metadata_ vectors grow unbounded with no eviction policy:\n```cpp\nstd::vector\u003cExpressFeedFrame\u003e express_feed_frames_{};\nstd::vector\u003cTradeMetadata\u003e trade_metadata_{};\n```\nIn production, these will consume unbounded memory. Need either:\n1. Ring buffer with fixed capacity\n2. Periodic eviction of old entries\n3. Configurable max size with FIFO eviction","status":"open","priority":2,"issue_type":"bug","created_at":"2025-11-30T20:15:54.017864-05:00","updated_at":"2025-11-30T20:15:54.017864-05:00"}
{"id":"MMPerp-bhz","title":"Implement real QUIC transport stack","description":"libs/ingest/src/quic_transport.cpp is a stub that stores callback without actual QUIC listener. Need to integrate real QUIC stack (quinn/libuv/etc).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T19:19:34.351059-05:00","updated_at":"2025-11-30T19:36:56.790277-05:00","closed_at":"2025-11-30T19:36:56.79028-05:00","comments":[{"id":5,"issue_id":"MMPerp-bhz","author":"danchou","text":"Implemented working transport layer with UDP backend. Created Transport abstraction (transport.hpp), UdpTransport with async receive loop, WireHeader protocol for frames. QuicTransport now uses UdpTransport internally. Full QUIC upgrade path documented in MMPerp-sah.","created_at":"2025-12-01T00:36:56Z"}]}
{"id":"MMPerp-bu3","title":"Replace telemetry latency buckets with streaming histogram","description":"Current vector-based latency buckets perform O(n log n) sort on drain. Unacceptable for high-frequency deployments. File: libs/telemetry/src/telemetry_sink.cpp:49-53","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T19:19:56.016137-05:00","updated_at":"2025-11-30T20:02:39.285216-05:00","closed_at":"2025-11-30T20:02:39.285218-05:00","comments":[{"id":8,"issue_id":"MMPerp-bu3","author":"danchou","text":"Implemented StreamingHistogram class using log2-scale buckets (30 buckets covering 1ns to ~1s). Recording is O(1) via std::bit_width. Percentile computation is O(30) = O(1). Removed O(n log n) sort on drain. Mean computed via running sum. Build and tests pass.","created_at":"2025-12-01T01:02:39Z"}]}
{"id":"MMPerp-cza","title":"ApiRouter not thread-safe for concurrent access","description":"In PR #1 api_router.hpp, the push/get methods are not thread-safe:\n```cpp\nvoid push_express_feed_frame(ExpressFeedFrame frame);\nstd::vector\u003cExpressFeedFrame\u003e get_express_feed_frames(...) const;\n```\nIf API handlers run on different threads (HTTP server threads), concurrent push/get will cause data races. Need mutex protection or lock-free data structures.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T20:15:56.740511-05:00","updated_at":"2025-11-30T20:15:56.740511-05:00"}
{"id":"MMPerp-czf","title":"WAL offset double-incremented per event in main.cpp","description":"In PR #1 main.cpp:137-138, wal_offset is incremented twice per event - once for trade metadata and once for express feed frame. This creates gaps and incorrect offsets:\n```cpp\n.wal_offset = wal_offset++,  // First increment\n...\n.wal_offset = wal_offset++,  // Second increment - creates gap\n```\nShould use a single wal_offset per order event, not per output.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-11-30T20:15:50.93264-05:00","updated_at":"2025-11-30T20:15:50.93264-05:00"}
{"id":"MMPerp-dge","title":"Hardcoded market ID=1 throughout main.cpp event loop","description":"In PR #1 main.cpp, market ID 1 is hardcoded in multiple places:\n- Line 81: `market = 1`\n- Line 90: `OrderId{.market = 1, ...}`\n- Line 159: `std::vector\u003ccommon::MarketId\u003e markets = {1}`\n\nShould derive market ID from the decoded SBE message instead of hardcoding. This prevents multi-market support.","status":"open","priority":3,"issue_type":"chore","created_at":"2025-11-30T20:15:55.971303-05:00","updated_at":"2025-11-30T20:15:55.971303-05:00"}
{"id":"MMPerp-jkq","title":"Implement O(1) order cancel using intrusive linked nodes","description":"Current deque walk in cancel path is O(n) per price level. Need true intrusive linked nodes with pointer stored in order record for O(1) cancel/replace. File: libs/matcher/src/matching_engine.cpp:37-52","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T19:19:56.152404-05:00","updated_at":"2025-11-30T20:01:18.261839-05:00","closed_at":"2025-11-30T20:01:18.261841-05:00","comments":[{"id":7,"issue_id":"MMPerp-jkq","author":"danchou","text":"Already implemented in commit c6d8516 (Refactor matcher core with intrusive book). OrderRecord now has prev/next/level pointers for O(1) unlinking. PriceLevel::remove() is O(1). Full cancel path is O(1): market lookup -\u003e order lookup in book_orders -\u003e level.remove() -\u003e erase.","created_at":"2025-12-01T01:01:18Z"}]}
{"id":"MMPerp-kqs","title":"Add snapshot compaction/rotation with integrity checks","description":"Snapshot store appends indefinitely with unbounded growth. Need rotation/compaction policy and CRC/Merkle commitment per chunk. File: libs/snapshot/src/snapshot_store.cpp:43","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:19:56.28878-05:00","updated_at":"2025-11-30T19:19:56.28878-05:00"}
{"id":"MMPerp-lzi","title":"Remove hardcoded /tmp paths from production main","description":"Production main.cpp uses hardcoded /tmp/tradecore.wal and /tmp/tradecore.snapshot paths. Should come from config system. File: apps/tradecored/src/main.cpp:49,52","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-11-30T19:20:11.223732-05:00","updated_at":"2025-11-30T19:30:52.905524-05:00","closed_at":"2025-11-30T19:30:52.905527-05:00","comments":[{"id":2,"issue_id":"MMPerp-lzi","author":"danchou","text":"Resolved by MMPerp-677 - config loader now provides paths from TOML config instead of hardcoded /tmp paths","created_at":"2025-12-01T00:30:52Z"}]}
{"id":"MMPerp-r94","title":"Implement ed25519 signature verification for ingress auth","description":"Production code provides no AuthVerifier to IngressPipeline. Need to implement ed25519 signature verification before production. Files: libs/ingest/include/tradecore/ingest/ingress_pipeline.hpp:34, apps/tradecored/src/main.cpp:21-23","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T19:19:34.462715-05:00","updated_at":"2025-11-30T19:40:04.903404-05:00","closed_at":"2025-11-30T19:40:04.903407-05:00","comments":[{"id":6,"issue_id":"MMPerp-r94","author":"danchou","text":"Implemented ed25519 signature verification using libsodium. Created auth module with Authenticator class for key management and FrameAuthenticator for frame verification. Updated main.cpp to create AuthVerifier callback and pass to IngressPipeline. Supports per-account public key registration.","created_at":"2025-12-01T00:40:04Z"}]}
{"id":"MMPerp-sah","title":"Upgrade UdpTransport to full QUIC using MsQuic","description":"UdpTransport is now working with QUIC-compatible wire protocol. Upgrade path: brew install libmsquic, then implement MsQuicTransport as alternative backend. Benefits: 0-RTT handshakes, connection migration, multiplexing.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:36:50.412866-05:00","updated_at":"2025-11-30T19:36:50.412866-05:00"}
{"id":"MMPerp-u3m","title":"Add determinism replay test to CI matrix","description":"Verify state reconstruction from WAL produces identical results. Critical for blockchain integration reliability.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:19:56.566184-05:00","updated_at":"2025-11-30T19:19:56.566184-05:00"}
{"id":"MMPerp-xt1","title":"Replace QuicTransport stub with real QUIC implementation","description":"QuicTransport.start() stores callback without starting listener - not a real implementation. Integrate quinn/libuv or similar QUIC library. File: libs/ingest/src/quic_transport.cpp:9 (Mock/stub removal)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T19:19:56.994655-05:00","updated_at":"2025-11-30T19:31:14.894493-05:00","closed_at":"2025-11-30T19:31:14.894496-05:00","comments":[{"id":4,"issue_id":"MMPerp-xt1","author":"danchou","text":"Duplicate of MMPerp-bhz - both describe implementing real QUIC transport","created_at":"2025-12-01T00:31:14Z"}]}
{"id":"MMPerp-xxp","title":"LiquidationExecutor doesn't apply fills to counterparty (maker)","description":"In PR #1 liquidation_executor.cpp:execute_liquidation(), fills are only applied to the liquidated account (taker), not to the counterparty (maker). When a liquidation matches against resting orders, those makers' positions must also be updated:\n```cpp\n// Current: only applies to order.account\n// Missing: apply fill to fill.maker_order counterparty\n```\nThis will cause position/PnL mismatches between accounts.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-11-30T20:15:53.078485-05:00","updated_at":"2025-11-30T20:15:53.078485-05:00"}
{"id":"MMPerp-yl4","title":"SBE decode functions lack bounds checking - potential OOB read","description":"In PR #1 sbe_messages.hpp, all decode_* functions read primitives without checking if data span has sufficient bytes:\n```cpp\ninline FillEvent decode_fill_event(std::span\u003cconst std::byte\u003e data) {\n  std::size_t offset = 0;\n  msg.maker_order_id = detail::read_primitive\u003cstd::uint64_t\u003e(data, offset);  // No bounds check\n  // ... reads continue without validation\n}\n```\nMalformed packets could cause out-of-bounds reads. Should check data.size() \u003e= expected_size before decoding.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-11-30T20:15:55.142311-05:00","updated_at":"2025-11-30T20:15:55.142311-05:00"}
{"id":"MMPerp-zgb","title":"Perp DEX competitive research \u0026 feature roadmap","description":"Research-driven feature roadmap based on competitive analysis of 21 perp DEXes. Key architectural patterns identified: ZK-rollup verification (Lighter, GRVT), validator-integrated matching (dYdX v4, Bulktrade), JIT auctions (Drift), privacy/hidden orders (Hibachi, GRVT), portfolio margin (Reya, Variational). MMPerp's ExEx integration and deterministic WAL replay align well with high-performance CLOB tier.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-30T19:54:01.944052-05:00","updated_at":"2025-11-30T19:54:01.944052-05:00"}
{"id":"MMPerp-zgb.1","title":"Add hidden/iceberg order support for dark pool trading","description":"Implement hidden order types (iceberg orders) for dark pool functionality. Used by GRVT (zkSync Validium), Aster, Hibachi. Orders show partial size publicly while hiding full quantity. Requires: hidden quantity field in Order struct, display qty vs actual qty tracking, special handling in match loop to refresh displayed qty after fills. Medium complexity - no consensus changes needed.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T19:54:20.671787-05:00","updated_at":"2025-11-30T20:12:43.540497-05:00","closed_at":"2025-11-30T20:12:43.540501-05:00","dependencies":[{"issue_id":"MMPerp-zgb.1","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:20.672115-05:00","created_by":"daemon"}],"comments":[{"id":12,"issue_id":"MMPerp-zgb.1","author":"danchou","text":"2025 research: Aster launched Hidden Orders in June 2025 as major differentiator. Implementation: limit orders without revealing size, price, or presence on public order book. Priority feature for institutional adoption. Starting implementation now.","created_at":"2025-12-01T01:09:11Z"},{"id":13,"issue_id":"MMPerp-zgb.1","author":"danchou","text":"Implemented hidden and iceberg order support:\n\n- Added kHidden and kIceberg flags to OrderFlags enum\n- Added display_quantity to OrderRequest for iceberg clip size\n- OrderRecord tracks display_remaining and display_size separately from remaining\n- PriceLevel tracks both total_qty (for matching) and visible_qty (for market data)\n- Iceberg orders automatically refresh display_remaining after fills\n- Hidden orders have display_remaining=0 (invisible on book, but still match)\n- Validation: iceberg display_quantity must be \u003e 0 and \u003c= quantity\n- Added comprehensive tests: test_hidden_orders, test_iceberg_orders, test_iceberg_validation\n\nMatches Aster DEX hidden orders feature launched June 2025.","created_at":"2025-12-01T01:12:43Z"}]}
{"id":"MMPerp-zgb.10","title":"Document MMPerp architecture vs competitor patterns","description":"Document architecture alignment with high-perf CLOB tier (Lighter, GRVT, Bulktrade, dYdX v4). Strengths: deterministic WAL replay, ed25519 auth at ingress, SPSC queues + PMR, cross-margin risk engine, ExEx integration. Gaps: no hidden orders, no portfolio margin P\u0026L offset, no JIT fallback. Create ARCHITECTURE.md comparing to competitors.","status":"open","priority":2,"issue_type":"chore","created_at":"2025-11-30T19:55:08.807078-05:00","updated_at":"2025-11-30T19:55:08.807078-05:00","dependencies":[{"issue_id":"MMPerp-zgb.10","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:08.807412-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.11","title":"Security audit checklist from perp DEX exploit research","description":"Security research from QuillAudits 2025 report: $3.2B+ losses from perp exploits in 2025. Key vectors: oracle manipulation, flash loan attacks, mass liquidation cascades, MEV front-running. Audit checklist: TWAP oracle validation, funding rate caps (96%/day max), liquidation bounty limits, partial liquidation (50% cap like GMX). Review MMPerp against these.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:55:09.867918-05:00","updated_at":"2025-11-30T19:55:09.867918-05:00","dependencies":[{"issue_id":"MMPerp-zgb.11","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:09.868283-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.12","title":"Research perpetual options product (Paradex model)","description":"Research perpetual options (Paradex model). No liquidation on price movement, no expiry. Combines perp mechanics with option payoffs. Paradex is first perp DEX on Starknet appchain with this feature. High complexity - requires option pricing model, delta/gamma hedging, and new risk calculations. Long-term consideration.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:55:11.028822-05:00","updated_at":"2025-11-30T19:55:11.028822-05:00","dependencies":[{"issue_id":"MMPerp-zgb.12","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:11.02915-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.13","title":"Study Hyperliquid HyperBFT consensus for execution optimization","description":"Hyperliquid L1 research: HyperBFT consensus (HotStuff variant), 100k orders/sec throughput, 200ms median/900ms p99 latency. Key insight: consensus and networking can scale to millions of orders/sec - execution is the bottleneck. MMPerp should focus on execution optimization. HyperCore targets 200k TPS. Fully on-chain orderbook without off-chain crutches.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:55:26.736137-05:00","updated_at":"2025-11-30T19:55:26.736137-05:00","dependencies":[{"issue_id":"MMPerp-zgb.13","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:26.736489-05:00","created_by":"daemon"}],"comments":[{"id":11,"issue_id":"MMPerp-zgb.13","author":"danchou","text":"2025 research update: Hyperliquid now at 200k orders/sec with HyperBFT. Key architecture: unified state between HyperCore (matching) and HyperEVM. Dual-block architecture (2s fast blocks + 1min slow blocks). Pipelined consensus allows sequencing next tx without waiting for current block hash. This is our target architecture for reth EVM + future SVM integration.","created_at":"2025-12-01T01:09:11Z"}]}
{"id":"MMPerp-zgb.14","title":"Study Drift 3-way liquidity architecture (DLOB + JIT + dAMM)","description":"Research Drift Protocol's 3-way liquidity system: 1) On-chain DLOB (decentralized limit order book), 2) JIT (Just-In-Time) liquidity from market makers, 3) dAMM (dynamic AMM) as backstop. Provides liquidity depth without pure AMM slippage or pure orderbook gaps. Could inform hybrid liquidity design for MMPerp.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:55:28.079326-05:00","updated_at":"2025-11-30T19:55:28.079326-05:00","dependencies":[{"issue_id":"MMPerp-zgb.14","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:28.079707-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.15","title":"Study Variational P2P RFQ bilateral settlement model","description":"Research Variational P2P RFQ model. Bilateral settlement without central orderbook. 515+ tradable tokens (most in any perp DEX). 0 trading fees (0.1 USDC deposit/withdraw only). 2-4% chance of loss refund. Decorrelation risk tuning for portfolio margin. Different paradigm from CLOB but interesting mechanics for specific use cases.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:55:29.386016-05:00","updated_at":"2025-11-30T19:55:29.386016-05:00","dependencies":[{"issue_id":"MMPerp-zgb.15","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:29.386365-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.2","title":"Implement portfolio margin with cross-position P\u0026L offset","description":"Implement portfolio margin with P\u0026L offset across positions. Used by Reya, GRVT, Variational. Allows unrealized profits in one position to offset margin requirements in another. Key formula: equity = collateral + sum(unrealizedPnL). Requires cross-position risk aggregation in RiskEngine. Variational adds decorrelation risk tuning. Medium complexity - extends existing cross-margin.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:54:22.040801-05:00","updated_at":"2025-11-30T19:54:22.040801-05:00","dependencies":[{"issue_id":"MMPerp-zgb.2","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:22.041119-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.3","title":"Add JIT Dutch auction fallback for market orders","description":"Add JIT (Just-In-Time) auction fallback for illiquid markets or large orders. Drift Protocol uses 5-second Dutch auctions for market orders when orderbook liquidity is thin. Market makers can bid to fill at improving prices. Complements price-time FIFO matching. Medium complexity - requires auction state machine and timeout handling.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:54:22.940283-05:00","updated_at":"2025-11-30T19:54:22.940283-05:00","dependencies":[{"issue_id":"MMPerp-zgb.3","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:22.940598-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.4","title":"Upgrade to velocity-based funding rate mechanism","description":"Implement velocity-based funding rate mechanism. Mars Protocol and Paradex use: r_t = r_{t-1} + maxFundingVelocity * pSkew * timeDelta/secondsInDay. Rate changes proportionally to skew persistence, not just instantaneous imbalance. Caps at 96%/day (4%/hr). More stable than instantaneous models. Low-medium complexity - FundingEngine refactor.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:54:24.015707-05:00","updated_at":"2025-11-30T19:54:24.015707-05:00","dependencies":[{"issue_id":"MMPerp-zgb.4","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:24.016037-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.5","title":"Research ZK proof integration for verifiable matching","description":"Add cryptographic receipts for every trade (Lighter model). ZK-SNARK proofs verify matching engine executed correctly. Provides escape hatch for L1 withdrawal if operator misbehaves. Lighter whitepaper: 'publicly verifiable compute engine that prevents operator misbehavior'. High complexity - requires ZK circuit development or TEE integration.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:54:40.790682-05:00","updated_at":"2025-11-30T19:54:40.790682-05:00","dependencies":[{"issue_id":"MMPerp-zgb.5","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:40.790995-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.6","title":"Add loss rebates for contrarian positions (Avantis model)","description":"Implement loss rebate system for contrarian positions. Avantis offers 20% loss rebates when traders take positions against the crowd (reducing skew). Incentivizes market balance. Formula: rebate = loss * rebate_rate if position_reduces_skew. Low complexity - post-liquidation/close hook in settlement.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:54:41.892245-05:00","updated_at":"2025-11-30T19:54:41.892245-05:00","dependencies":[{"issue_id":"MMPerp-zgb.6","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:41.892581-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.7","title":"Benchmark latency metrics against competitor targets","description":"Benchmark latency metrics against 2025 competitor targets. Hyperliquid: 200ms median, 900ms p99 end-to-end (includes consensus). 200k orders/sec throughput. MMPerp target: sub-microsecond internal matching latency, 500k+ orders/sec throughput to exceed Hyperliquid when consensus is not bottleneck.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T19:54:43.28365-05:00","updated_at":"2025-11-30T20:09:11.915184-05:00","dependencies":[{"issue_id":"MMPerp-zgb.7","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:43.283977-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.8","title":"Research yield-bearing collateral integration","description":"Research yield-bearing collateral integration. Ethereal uses USDe (Ethena synthetic dollar), Aster uses asBNB earning 5-7% APY. Collateral earns yield while backing positions. Requires: yield-bearing token wrapper, interest accrual in margin calculations, integration with external yield sources. Medium complexity but external dependencies.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T19:54:44.834908-05:00","updated_at":"2025-11-30T19:54:44.834908-05:00","dependencies":[{"issue_id":"MMPerp-zgb.8","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:54:44.835223-05:00","created_by":"daemon"}]}
{"id":"MMPerp-zgb.9","title":"Evaluate dYdX-style off-consensus orderbook storage","description":"dYdX v4 architecture insight: orderbook lives in validator memory and is NEVER committed to consensus. Only matched trades hit the chain. This dramatically reduces state bloat. Evaluate if MMPerp's WAL can adopt similar pattern - store pending orders off-consensus, only persist fills. Could improve throughput from current estimates.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T19:55:07.250422-05:00","updated_at":"2025-11-30T20:09:08.977463-05:00","closed_at":"2025-11-30T20:09:08.977465-05:00","dependencies":[{"issue_id":"MMPerp-zgb.9","depends_on_id":"MMPerp-zgb","type":"parent-child","created_at":"2025-11-30T19:55:07.25078-05:00","created_by":"daemon"}],"comments":[{"id":10,"issue_id":"MMPerp-zgb.9","author":"danchou","text":"REJECTED: After researching 2025 Hyperliquid architecture, decided against dYdX-style off-consensus orderbook. Hyperliquid explicitly calls out 'no crutch of off-chain order books' as a core design principle and achieves 200k orders/sec with fully on-chain CLOB. Our architecture will follow Hyperliquid's approach - matching engine state goes through consensus for full decentralization. The execution bottleneck is addressable through C++ optimization without sacrificing on-chain transparency.","created_at":"2025-12-01T01:09:08Z"}]}
